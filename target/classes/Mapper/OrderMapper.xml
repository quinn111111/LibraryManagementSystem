<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.OrderMapper">

    <sql id="selectAllColumns">
        SELECT * FROM `Order`
    </sql>

    <select id="findOrderByTime" parameterType="String" resultType="Entity.Order">
        <include refid="selectAllColumns"></include>
        where Floor = #{Floor} AND
        (BeginTime &lt;= #{BeginTime} AND EndTime >= #{EndTime}) OR
        (BeginTime >= #{BeginTime} AND BeginTime &lt;= #{EndTime}) OR
        (EndTime >= #{BeginTime} AND EndTime &lt;= #{EndTime})
    </select>

    <!--通过id查询-->
    <select id="findOrderById" parameterType="String"
            resultType="Entity.Order">
        select * from 'Order' where OrderId = #{value}
    </select>
    <select id="findOrderById2" parameterType="String" resultType="Entity.Order">
        <include refid="selectAllColumns"></include>
        WHERE OrderId = #{OrderId}
    </select>

    <select id="findOrderByUserId" parameterType="String"
            resultType="Entity.Order">
        select * from 'Order' where UserId = #{value}
    </select>

    <select id="findOrderBySeatId" parameterType="String"
            resultType="Entity.Order">
        select * from 'Order' where SeatId = #{value}
    </select>


    <!-- 添加信息 -->
    <insert id="addOrder" parameterType="Entity.Order">
        insert into `Order`(OrderId,VerifyCode,OrderDate,BeginTime,EndTime,UserId,SeatId) values(#{OrderId},#{VerifyCode},#{OrderDate},#{BeginTime},#{EndTime},#{UserId},#{SeatId})
    </insert>

    <!-- 删除方法 -->
    <delete id="deleteOrderById" parameterType="String">
        DELETE FROM 'Order' WHERE OrderId = #{OrderId}
    </delete>

    <!-- 修改方法 -->
    <update id="updateOrder" parameterType="Entity.Order">
        UPDATE 'Order' SET
                        VerifyCode=#{VerifyCode},BeginTime=#{BeginTime},UserId=#{UserId},SeatId=#{SeatId}
        where OrderId = #{OrderId}
    </update>


    <!--条件查询-->
    <sql id="queryOrderWhere">
        <if test="OrderId!=0 and OrderId!='' and OrderId!=null">
            AND OrderId = #{OrderId}
        </if>
        <if test="VerifyCode!='' and VerifyCode!=null">
            AND VerifyCode = #{VerifyCode}
        </if>
        <if test="OrderStatus!='' and OrderStatus!=null">
            AND BeginTime = #{BeginTime}
        </if>
        <if test="UserId!='' and UserId!=null">
            AND UserId = #{UserId}
        </if>
        <if test="SeatId!='' and SeatId!=null">
            AND SeatId = #{SeatId}
        </if>
    </sql>
    <select id="findOrdersByConditions" parameterType="Entity.Order"
            resultType="Entity.Order">
        <include refid="selectAllColumns"></include>
        <where>
            <include refid="queryOrderWhere"></include>
        </where>
    </select>


    <select id="findOrderMap" parameterType="Entity.Order"
            resultType="java.util.Map">
        <include refid="selectAllColumns"></include>
        <where>
            <include refid="queryOrderWhere"></include>
        </where>
    </select>

</mapper>
